{"remainingRequest":"/home/muhammadawd/WebstormProjects/Guardian/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/home/muhammadawd/WebstormProjects/Guardian/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/muhammadawd/WebstormProjects/Guardian/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/muhammadawd/WebstormProjects/Guardian/src/views/Attendance/Teacher/AttendanceReport.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/muhammadawd/WebstormProjects/Guardian/src/views/Attendance/Teacher/AttendanceReport.vue","mtime":1579684620811},{"path":"/home/muhammadawd/WebstormProjects/Guardian/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/muhammadawd/WebstormProjects/Guardian/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/muhammadawd/WebstormProjects/Guardian/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/muhammadawd/WebstormProjects/Guardian/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.from\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport XLSX from 'xlsx';\nimport flatPickr from 'vue-flatpickr-component';\nimport 'flatpickr/dist/flatpickr.css';\nexport default {\n  data: function data() {\n    return {\n      selectValue: null,\n      tableData: [],\n      isLoading: true,\n      disable: false,\n      days_count: 30,\n      months: [{\n        value: 1,\n        title: 'يناير'\n      }, {\n        value: 2,\n        title: 'فبراير'\n      }, {\n        value: 3,\n        title: 'مارس'\n      }, {\n        value: 4,\n        title: 'ابريل'\n      }, {\n        value: 5,\n        title: 'مايو'\n      }, {\n        value: 6,\n        title: 'يونية'\n      }, {\n        value: 7,\n        title: 'يوليو'\n      }, {\n        value: 8,\n        title: 'اغسطس'\n      }, {\n        value: 9,\n        title: 'سبتمبر'\n      }, {\n        value: 10,\n        title: 'اكتوبر'\n      }, {\n        value: 11,\n        title: 'نوفمبر'\n      }, {\n        value: 12,\n        title: 'ديسمبر'\n      }],\n      dataModel: {\n        // date: new Date(),\n        month: new Date().getMonth() + 1,\n        year: new Date().getFullYear()\n      }\n    };\n  },\n  mounted: function mounted() {\n    var vm = this;\n    vm.getAllAbsence();\n  },\n  components: {\n    flatPickr: flatPickr\n  },\n  computed: {\n    years: function years() {\n      var year = new Date().getFullYear();\n      return Array.from({\n        length: year - 2010\n      }, function (value, index) {\n        return 2011 + index;\n      });\n    }\n  },\n  methods: {\n    getDates: function getDates(day) {\n      return _.map(day, 'time');\n    },\n    print: function print() {\n      window.print(); // this.$htmlToPaper('printMe')\n    },\n    exportDataXlsx: function exportDataXlsx() {\n      var vm = this;\n      var arrData = vm.prepareData();\n      var attendanceWS = XLSX.utils.json_to_sheet(arrData);\n      var wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, attendanceWS, 'students');\n      XLSX.writeFile(wb, 'Attendance' + new Date().getTime() + '.xlsx');\n    },\n    prepareData: function prepareData() {\n      var vm = this;\n      var header = [];\n      var body = [];\n      header.push(null);\n\n      for (var i = 0; i < vm.days_count; i++) {\n        header.push(i + 1);\n      }\n\n      body.push(header);\n\n      _.forEach(vm.tableData, function (item, index) {\n        var row = [];\n        var client = item.name;\n        var days = item.days;\n        row.push(client);\n\n        _.forEach(days, function (item, index) {\n          var _days = vm.getDates(item);\n\n          var days_str = _.join(_days, '~');\n\n          row.push(days_str);\n        });\n\n        body.push(row);\n      });\n\n      console.log(body);\n      return body;\n    },\n    getAllAbsence: function getAllAbsence() {\n      var vm = this;\n      vm.$root.$children[0].$refs.loader.show_loader = true;\n\n      try {\n        window.serviceAPI.API().get(window.serviceAPI.ALL_TEACHERS_GET_ABSENCE, {\n          params: vm.dataModel\n        }).then(function (response) {\n          vm.$root.$children[0].$refs.loader.show_loader = false;\n          response = response.data;\n\n          if (response.status) {\n            vm.tableData = response.data.teachers;\n            vm.days_count = response.data.days_count;\n            return null;\n          }\n\n          vm.tableData = [];\n        }).catch(function (error) {\n          vm.$root.$children[0].$refs.loader.show_loader = false;\n          window.helper.handleError(error, vm);\n          vm.tableData = [];\n        });\n      } catch (e) {\n        console.log(e);\n      }\n    }\n  }\n};",{"version":3,"sources":["AttendanceReport.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n\n    <div class=\"vx-row\">\n      <div class=\"vx-col w-full\">\n        <div class=\"vx-row\">\n          <div class=\"vx-col md:w-1/4 mb-base\">\n            <vs-select class=\"w-full\" v-model=\"dataModel.month\" @change=\"getAllAbsence()\">\n              <vs-select-item v-for=\"(month , key) in months\" :key=\"key\" :text=\"month.title\"\n                              :value=\"month.value\"></vs-select-item>\n            </vs-select>\n          </div>\n          <div class=\"vx-col md:w-1/4 mb-base\">\n            <vs-select class=\"w-full\" v-model=\"dataModel.year\" @change=\"getAllAbsence()\">\n              <vs-select-item v-for=\"(year , key) in years\" :key=\"key\" :text=\"year\" :value=\"year\"></vs-select-item>\n            </vs-select>\n          </div>\n        </div>\n\n        <div class=\"vx-row\">\n          <div class=\"vx-col md:w-1/2 mb-base\">\n            <vs-button class=\"d-print-none\" @click=\"$router.push({name:'attendance_teacher_add'})\">\n              <i class=\"fas fa-plus\"></i>\n            </vs-button>\n            &nbsp;\n            <vs-button class=\"d-print-none\" @click=\"print()\">\n              <i class=\"fas fa-print\"></i>\n            </vs-button>\n            &nbsp;\n            <vs-button class=\"btn btn-dark d-print-none\" @click=\"exportDataXlsx()\" :disabled=\"!tableData.length\">\n              {{$ml.get('download')}}\n            </vs-button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"container-fluid mt--7\">\n      <div class=\"row \">\n        <div class=\"col\">\n          <div class=\"card shadow border-0\">\n            <div class=\"map-canvas\"\n                 style=\"min-height: 600px;\">\n              <div class=\"table-responsive\">\n                <div class=\"main-content\">\n                  <div class=\"title\">\n                    {{$ml.get('attendance_report')}}\n                    ({{months[dataModel.month - 1] ? months[dataModel.month - 1].title : ''}} - {{dataModel.year}})\n                  </div>\n                  <div class=\"table-responsive\">\n                    <table class=\"table\" id=\"printMe\">\n                      <tr class=\"cells\">\n                        <td class=\"cells__spacer\"></td>\n                        <td class=\"cells__alphabet text-center bg-white\" v-for=\"(_day , key) in days_count\"\n                            :key=\"key\">\n                          <span style=\"color: #000;\">{{_day}}</span>\n                        </td>\n                      </tr>\n\n                      <tr class=\"cells\" v-for=\"(person , index) in tableData\" :key=\"index\">\n                        <td class=\"cells__names text-right\" dir=\"rtl\">{{person.name}}</td>\n                        <td class=\"cells__alphabet text-center bg-white\"\n                            v-for=\"(day , key) in person.days\" :key=\"key\">\n                          <div v-if=\"!getDates(day).length\"><i\n                            class=\"fas fa-times text-danger\"></i></div>\n                          <div v-for=\"time in getDates(day)\" class=\"font-weight-bold\">\n                            {{time}}\n                          </div>\n                        </td>\n                      </tr>\n\n                    </table>\n                  </div>\n                  <!--                                    <div class=\"cells\">-->\n                  <!--                                        <div class=\"cells__spacer\"></div>-->\n                  <!--                                        <div class=\"cells__alphabet\" v-for=\"(day , key) in 31\">{{day}}</div>-->\n                  <!--                                        &lt;!&ndash;                                        <input class=\"cells__input\"/>&ndash;&gt;-->\n                  <!--                                    </div>-->\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\n  import XLSX from 'xlsx'\n  import flatPickr from 'vue-flatpickr-component';\n  import 'flatpickr/dist/flatpickr.css';\n\n  export default {\n    data() {\n      return {\n        selectValue: null,\n        tableData: [],\n        isLoading: true,\n        disable: false,\n        days_count: 30,\n        months: [\n          {\n            value: 1,\n            title: 'يناير',\n          },\n          {\n            value: 2,\n            title: 'فبراير',\n          },\n          {\n            value: 3,\n            title: 'مارس',\n          },\n          {\n            value: 4,\n            title: 'ابريل',\n          },\n          {\n            value: 5,\n            title: 'مايو',\n          },\n          {\n            value: 6,\n            title: 'يونية',\n          },\n          {\n            value: 7,\n            title: 'يوليو',\n          },\n          {\n            value: 8,\n            title: 'اغسطس',\n          },\n          {\n            value: 9,\n            title: 'سبتمبر',\n          },\n          {\n            value: 10,\n            title: 'اكتوبر',\n          },\n          {\n            value: 11,\n            title: 'نوفمبر',\n          },\n          {\n            value: 12,\n            title: 'ديسمبر',\n          },\n        ],\n        dataModel: {\n          // date: new Date(),\n          month: (new Date()).getMonth() + 1,\n          year: (new Date()).getFullYear()\n        }\n      }\n    },\n    mounted() {\n      let vm = this;\n      vm.getAllAbsence();\n    },\n    components: {\n      flatPickr\n    },\n    computed: {\n      years() {\n        const year = new Date().getFullYear()\n        return Array.from({length: year - 2010}, (value, index) => 2011 + index)\n      }\n    },\n    methods: {\n      getDates(day) {\n        return _.map(day, 'time')\n      },\n      print() {\n        window.print()\n        // this.$htmlToPaper('printMe')\n      },\n      exportDataXlsx() {\n        let vm = this;\n        let arrData = vm.prepareData();\n        var attendanceWS = XLSX.utils.json_to_sheet(arrData)\n        var wb = XLSX.utils.book_new();\n        XLSX.utils.book_append_sheet(wb, attendanceWS, 'students');\n        XLSX.writeFile(wb, 'Attendance' + (new Date()).getTime() + '.xlsx')\n      },\n      prepareData() {\n        let vm = this;\n        let header = [];\n        let body = [];\n        header.push(null);\n        for (let i = 0; i < vm.days_count; i++) {\n          header.push(i + 1)\n        }\n        body.push(header);\n        _.forEach(vm.tableData, (item, index) => {\n          let row = [];\n          let client = item.name;\n          let days = item.days;\n          row.push(client);\n          _.forEach(days, (item, index) => {\n            let _days = vm.getDates(item);\n            let days_str = _.join(_days, '~');\n            row.push(days_str)\n          });\n          body.push(row)\n        });\n        console.log(body)\n        return body;\n      },\n      getAllAbsence() {\n        let vm = this;\n        vm.$root.$children[0].$refs.loader.show_loader = true;\n        try {\n          window.serviceAPI.API().get(window.serviceAPI.ALL_TEACHERS_GET_ABSENCE, {\n            params: vm.dataModel\n          })\n            .then((response) => {\n              vm.$root.$children[0].$refs.loader.show_loader = false;\n              response = response.data;\n              if (response.status) {\n                vm.tableData = response.data.teachers;\n                vm.days_count = response.data.days_count;\n                return null;\n              }\n              vm.tableData = [];\n\n            }).catch((error) => {\n            vm.$root.$children[0].$refs.loader.show_loader = false;\n            window.helper.handleError(error, vm);\n            vm.tableData = [];\n          });\n        } catch (e) {\n          console.log(e)\n        }\n      }\n    }\n  }\n</script>\n\n<style scoped>\n\n  .main-content {\n    min-height: 50vh;\n    max-width: 100%;\n  }\n\n  .main-content > div {\n    max-width: 100%;\n  }\n\n  .title {\n    background: #217346;\n    text-align: center;\n    place-content: center;\n    color: #fff;\n    height: 50px;\n    font-size: 20px;\n    font-weight: bold;\n    padding-top: 10px;\n  }\n\n  .cells {\n    position: relative;\n  }\n\n  .cells__spacer {\n    background: #e6e6e6;\n    position: relative;\n    border-left: 1px solid #888;\n  }\n\n  .cells__spacer:after {\n    content: \"\";\n    position: absolute;\n    left: 50%;\n    bottom: 4px;\n    height: 80%;\n    width: 100%;\n    background: linear-gradient(135deg, transparent 30px, #bbb 43px, #bbb 55px, transparent 55px)\n  }\n\n  .cells__alphabet {\n    background: #e6e6e6;\n    width: 80px;\n    border-left: 1px solid #ccc;\n    border-bottom: 1px solid #ccc;\n    text-align: center;\n  }\n\n  .cells__names {\n    background: #e6e6e6;\n    width: 80px;\n    border-left: 1px solid #ccc;\n    border-top: 1px solid #ccc;\n    border-bottom: 1px solid #ccc;\n    text-align: center;\n    font-weight: bold;\n    padding: 5px 15px;\n    white-space: pre;\n  }\n\n  .card .table td, .card .table th {\n    text-align: right;\n    padding: 8px;\n  }\n\n  .table-responsive {\n    overflow: scroll;\n  }\n</style>\n"],"sourceRoot":"src/views/Attendance/Teacher"}]}